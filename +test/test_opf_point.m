clear all

% point = [...
%  8.890444343633876
%  4.9428166219151635
%  6.52
%  5.08
%  6.87
%  5.8
%  2.284266088793775
%  6.384624870201319
%  9.723747727908162
%  0.9762752857978356
%  0.9729505165266146
%  0.9531434554452778
%  0.9814916531831815
%  0.944983867753555
%  1.0145902997428813
%  1.0577807513753095
%  0.9528244304342524
%  0.9400000015122388
%  0.9958439797825895];


% point = [...
%  4.304139963176226 
%  6.38977392687516  
%  6.52
%  5.063438496039463
%  6.124028982096551
%  5.8
%  5.64
%  8.65
%  8.138495900940605
%  0.977245384355747
%  0.9550737469018766
%  0.959414912785247
%  0.9612280467284717
%  0.9602335223235733
%  1.0003629844752504
%  0.9690433403407608
%  0.9722620851655416
%  1.0114898307074804
%  0.9440100526456476];

point = [...
8.244940053378668 
7.25
6.52
5.08
6.87
4.537820908178628 
5.479942226643743
8.629557985026281
4.1434186053351345
1.005906656780114 
0.9400000138388718
0.9581377268366186
1.0233577759306827
1.0191394348243836
1.0591420401044567
1.0599999910187845
0.9708355065587787
0.9417296673322798
1.0054243681464703];


c39 = 'case_files/case39.m';
mmc = loadcase(c39);

mmc.gen([1,3:end],2) = point(1:9).*100;
mmc.gen(:,6) = point(10:end);


res = runpf(mmc);
v = test.checklimits(res,1,0);






% all these 3 random points passed - w ? t ? f ?
% lets try with psat as well



%% 
PSAT_FILE = 'case_files\d_case39.m';
ps = psat('command_line_psat',true,'nosplash',true);
ps.clpsat.mesg = 0;
ps.clpsat.readfile = 0;
ps.runpsat(PSAT_FILE,'data')
ps.runpsat('pf')
ps.Settings.pv2pq = 1;
ps.PVSet(point)
ps.runpsat('pf')
res_psat = ps.powerFlowResults('print');
[opfStab,opfDet] = DirectedWalks.checkOPFLimits(mmc, res_psat, 'print')%#ok
